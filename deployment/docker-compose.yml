version: '3'

services:
    es:
      build: "elasticsearch"
      ports:
        - "9200:9200"
        - "9300:9300"
      networks:
        - "elk"
      volumes:
        - ./elasticsearch/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml
    kibana:
      build: "kibana"
      ports: 
        - "5601:5601"
      networks:
        - "elk"
      volumes:
        - ./kibana/kibana.yml:/usr/share/kibana/config/kibana.yml
    logstash:
      build: "logstash"
      ports:
        - "5044:5044"
      networks: 
        - "elk"
      volumes:
        - ./logstash/logstash.yml:/usr/share/logstash/config/logstash.yml
        - ./logstash/pipeline/:/usr/share/logstash/pipeline/
        - ./logstash/patterns/:/usr/share/logstash/patterns/
    apachebeat:
      build: "filebeat"
      networks:
        - elk
      volumes:
        - ./../test_logs/apache/:/var/log/apache
      environment:
        - BEAT_NAME=apache-beat
    firebeat:
      build: "filebeat"
      networks:
       - elk
      volumes:
       - ./../test_logs/firewall/:/var/log/firewall
      environment:
       - BEAT_NAME=fire-beat
    

    # redis:
    #   image: "redis:alpine"
    #   ports:
    #     - "6379:6379"
    #   networks: 
    #     - elk

networks: 
  elk:
    driver: bridge

  